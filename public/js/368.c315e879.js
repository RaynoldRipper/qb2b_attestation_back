"use strict";(self["webpackChunkquasar_app"]=self["webpackChunkquasar_app"]||[]).push([[368],{1327:(e,t,s)=>{s.d(t,{tC:()=>d,xO:()=>m});var a=s(7083),r=s(52),l=s.n(r),i=(s(3459),s(5343)),o=s(8669),n=s(4434);const m={token:"$P$ByJtUe8KliwKh9WNUDkZFpsvJfm5K11"},d=l().create({baseURL:"https://vo.qb2b.ru",withCredentials:!0});d.interceptors.request.use((e=>{let t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e))),d.interceptors.response.use((e=>(e.data.message&&n.Z.create({type:"positive",message:e.data.message}),e)),(e=>(401===e.response.status&&(e.response.message&&n.Z.create({type:"negative",message:e.response.message}),i["default"].dispatch("user/clearStorage"),o.Z.go("/login")),e)));(0,a.xr)((({app:e})=>{e.config.globalProperties.$axios=l(),e.config.globalProperties.$api=d}))},4743:(e,t,s)=>{s.d(t,{Z:()=>r});s(5363);const a={phoneFormat(e){return e.toString().replace(/\D+/g,"").replace(/(\d{1})(\d{3})(\d{3})(\d{2})(\d{2})/,"$1-($2)-$3-$4-$5")},dateFormat(e){return new Date(e).toLocaleDateString()}},r=a},4429:(e,t,s)=>{s.d(t,{CU:()=>r,fH:()=>l,Bm:()=>i});var a=s(5474);s(1327);const r=async(e,t=null)=>new Promise(((s,r)=>{a.api.post(e,t).then((e=>{e.status>=200&&e.status<300?s(e):r(e)})).catch((e=>{r(e)}))})),l=async e=>new Promise(((t,s)=>{a.api["delete"](e).then((e=>{e.status>=200&&e.status<300?t(e):s(e)})).catch((e=>{s(e)}))})),i=async(e,t)=>new Promise(((s,r)=>{a.api.put(e,t).then((e=>{e.status>=200&&e.status<300?s(e):r(e)})).catch((e=>{r(e)}))}))},8300:(e,t,s)=>{s.d(t,{Zm:()=>l,$5:()=>i,tB:()=>o,xS:()=>n});var a=s(5474),r=s(1327);const l={async updateUserMeta(e,t){return t.user_id=e,new Promise(((e,s)=>{a.api.post("/api/updateUserMeta",t).then((t=>e(t))).catch((e=>s(e)))}))},async updateUserMetaFormData(e,t){return t.user_id=e,new Promise(((e,s)=>{a.api.post("/api/user-meta-reserve",t).then((t=>e(t))).catch((e=>s(e)))}))},async deleteUser(e){return new Promise(((t,s)=>{a.api["delete"]("/api/users/"+e).then((e=>t(e))).catch((e=>s(e)))}))},vo:{async findUserByPhone(e){return r.xO.method="find-user-by-phone",r.xO.phone=e,new Promise(((e,t)=>{r.tC.post("/api/",r.xO).then((t=>e(t))).catch((e=>t(e)))}))},async registrationUser(e){return r.xO.method="create-user",r.xO.phone=e.phone,r.xO.first_name=e.first_name,r.xO.last_name=e.last_name,r.xO.middle_name=e.middle_name,r.xO.password=e.password,new Promise(((e,t)=>{r.tC.post("/api/",r.xO).then((t=>e(t))).catch((e=>t(e)))}))},async deleteUser(e){return r.xO.method="delete-user",r.xO.user_vo_id=e,new Promise(((e,t)=>{r.tC.post("/api/",r.xO).then((t=>e(t))).catch((e=>t(e)))}))},async managerToUser(e){return r.xO.method="manager-to-user",r.xO.user_vo_id=e,new Promise(((e,t)=>{r.tC.post("/api/",r.xO).then((t=>e(t))).catch((e=>t(e)))}))},async userToManager(e){return r.xO.method="user-to-manager",r.xO.user_vo_id=e,new Promise(((e,t)=>{r.tC.post("/api/",r.xO).then((t=>e(t))).catch((e=>t(e)))}))}}},i=e=>{let t="";switch(e){case"EMPLOYEE":t="Сотрудник";break;case"CANDIDATE":t="Пользователь";break;case"RESERVE":t="Пользователь";break;case"INTERNAL_RESERVE":t="Сотрудник";break;case"FIRED":t="Уволен";break}return t},o=e=>{let t="";switch(e){case"EMPLOYEE":t="";break;case"CANDIDATE":t="";break;case"RESERVE":t="Кадровый резерв";break;case"INTERNAL_RESERVE":t="Внутренний кадровый резерв";break;case"FIRED":t="";break}return t},n=e=>{let t="";switch(e){case"EMPLOYEE":t="positive";break;case"CANDIDATE":t="warning";break;case"RESERVE":t="warning";break;case"INTERNAL_RESERVE":t="warning";break;case"FIRED":t="negative";break}return t}},2368:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Us});var a=s(3673),r=s(2323);const l=(0,a._)("div",{class:"text-h6 q-mb-lg"},' Подтверждение прохождения заданий тестирования "Карта КУБ2Б" ',-1),i={class:"buttons-wrap"},o=(0,a._)("div",{class:"text-h6 q-mb-lg"}," История прохождения тестов ",-1),n=["innerHTML"];function m(e,t,s,m,d,u){const p=(0,a.up)("UserInfoSkeleton"),c=(0,a.up)("q-avatar"),_=(0,a.up)("q-item-section"),g=(0,a.up)("q-item-label"),h=(0,a.up)("q-badge"),y=(0,a.up)("q-item"),f=(0,a.up)("q-tab"),U=(0,a.up)("q-tabs"),w=(0,a.up)("q-separator"),v=(0,a.up)("TabInfo"),b=(0,a.up)("q-tab-panel"),q=(0,a.up)("TabTestsResult"),E=(0,a.up)("q-checkbox"),k=(0,a.up)("q-btn"),x=(0,a.up)("q-list"),S=(0,a.up)("TableInfoSkeleton"),T=(0,a.up)("q-card-section"),R=(0,a.up)("q-card"),W=(0,a.up)("q-expansion-item"),D=(0,a.up)("q-tab-panels");return null==d.user&&null==d.tests?((0,a.wg)(),(0,a.j4)(p,{key:0})):((0,a.wg)(),(0,a.j4)(R,{key:1,class:"my-card q-pt-md",flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"secondary","text-color":"white"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(u.firstLetterName),1)])),_:1})])),_:1}),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(d.user.family+" "+d.user.name+" "+d.user.middle_name),1)])),_:1}),(0,a.Wm)(g,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(d.user.role),1)])),_:1})])),_:1}),(0,a.Wm)(_,{style:{position:"relative"},side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-mb-sm",color:u.userStatusColor},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(u.userMainStatusText),1)])),_:1},8,["color"]),u.userSubStatusText?((0,a.wg)(),(0,a.j4)(h,{key:0,color:u.userStatusColor,outline:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(u.userSubStatusText),1)])),_:1},8,["color"])):(0,a.kq)("",!0)])),_:1})])),_:1}),(0,a.Wm)(T,null,{default:(0,a.w5)((()=>[(0,a.Wm)(U,{modelValue:d.tab,"onUpdate:modelValue":t[0]||(t[0]=e=>d.tab=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary","narrow-indicator":""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"info",label:"Информация"}),(0,a.Wm)(f,{name:"tests",label:"Результаты тестирования"}),"PASSED"!=u.attestationStatus?((0,a.wg)(),(0,a.j4)(f,{key:0,name:"test-qb2b-map",label:"Тестирование Карта КУБ2Б"})):(0,a.kq)("",!0),(0,a.Wm)(f,{name:"archive",label:"История"})])),_:1},8,["modelValue"]),(0,a.Wm)(w),(0,a.Wm)(D,{modelValue:d.tab,"onUpdate:modelValue":t[1]||(t[1]=e=>d.tab=e),animated:""},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{name:"info"},{default:(0,a.w5)((()=>[(0,a.Wm)(v)])),_:1}),(0,a.Wm)(b,{name:"tests"},{default:(0,a.w5)((()=>[(0,a.Wm)(q)])),_:1}),(0,a.Wm)(b,{name:"test-qb2b-map"},{default:(0,a.w5)((()=>[l,d.mapTest?((0,a.wg)(),(0,a.j4)(x,{key:0},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.mapTest.value.results.tasks,(e=>((0,a.wg)(),(0,a.j4)(y,{tag:"label",key:e},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{modelValue:e.status,"onUpdate:modelValue":t=>e.status=t,color:"secondary"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),(0,a._)("div",i,[(0,a.Wm)(k,{color:"primary",icon:"check",label:"Сохранить",onClick:u.saveMapTest},null,8,["onClick"])])])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(b,{name:"archive"},{default:(0,a.w5)((()=>[o,null===d.attestations?((0,a.wg)(),(0,a.j4)(x,{key:0,bordered:"",separator:""},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{rows:6})])),_:1})):((0,a.wg)(),(0,a.j4)(x,{key:1,bordered:"",separator:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.attestations,((e,t)=>((0,a.wg)(),(0,a.j4)(W,{key:t,onBeforeShow:t=>u.attestationTests(e.id)},{header:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Аттестация от "+(0,r.zw)(u.dateFormat(e.date_start))+" "+(0,r.zw)(this.attestationPositionName(e)),1)])),_:2},1024)])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>["undefined"==typeof d.attestations||null===d.attestations?((0,a.wg)(),(0,a.j4)(S,{key:0,rows:6})):((0,a.wg)(),(0,a.j4)(T,{key:1,class:"text-caption"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.tests,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a._)("h6",null,(0,r.zw)(e.name),1),(0,a._)("div",{innerHTML:u.testResult(e)},null,8,n)])))),128))])),_:2},1024))])),_:2},1024)])),_:2},1032,["onBeforeShow"])))),128))])),_:1}))])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}))}var d=s(5474),u=s(1959);const p={class:"row justify-center q-mb-md"},c={class:"col-2 q-mr-md"},_={class:"col-2 q-mr-md"},g={class:"col-2"},h={class:"q-mt-md"},y={class:"col-2 q-mb-md"};function f(e,t,s,r,l,i){const o=(0,a.up)("q-skeleton"),n=(0,a.up)("q-item-section"),m=(0,a.up)("q-item-label"),d=(0,a.up)("q-item"),u=(0,a.up)("q-separator"),f=(0,a.up)("q-card-section"),U=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(U,{class:"my-card q-pt-md q-mb-sm",flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{style:{"max-width":"250px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{type:"QAvatar"})])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(o,{type:"text"})])),_:1}),(0,a.Wm)(m,{caption:""},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{type:"text",width:"65%"})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("div",p,[(0,a._)("div",c,[(0,a.Wm)(o,{type:"rect"})]),(0,a._)("div",_,[(0,a.Wm)(o,{type:"rect"})]),(0,a._)("div",g,[(0,a.Wm)(o,{type:"rect"})])]),(0,a.Wm)(u),(0,a._)("div",h,[(0,a._)("div",y,[(0,a.Wm)(o,{type:"rect",width:"40%"})]),(0,a._)("div",null,[(0,a.Wm)(o,{type:"text"})]),(0,a._)("div",null,[(0,a.Wm)(o,{type:"text"})]),(0,a._)("div",null,[(0,a.Wm)(o,{type:"text",width:"50%"})])])])),_:1})])),_:1})}const U={};var w=s(151),v=s(3414),b=s(2035),q=s(4103),E=s(2350),k=s(5589),x=s(5869),S=s(7518),T=s.n(S);U.render=f;const R=U;function W(e,t,s,r,l,i){const o=(0,a.up)("q-skeleton"),n=(0,a.up)("q-card-section");return(0,a.wg)(),(0,a.j4)(n,{class:"text-caption"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.rows,(e=>((0,a.wg)(),(0,a.j4)(o,{class:"q-mb-sm",key:e})))),128))])),_:1})}T()(U,"components",{QCard:w.Z,QItem:v.Z,QItemSection:b.Z,QSkeleton:q.ZP,QItemLabel:E.Z,QCardSection:k.Z,QSeparator:x.Z});const D={props:{rows:Number}};D.render=W;const V=D;T()(D,"components",{QCardSection:k.Z,QSkeleton:q.ZP});var Z=s(306),I=s(4743),C=s(8300),A=s(3617);const M={key:0},$=(0,a._)("div",{class:"text-h6 q-mb-lg"}," Основная информация пользователя ",-1),N={class:"row q-col-gutter-md"},Q={class:"col-4"},L={class:"user-info__item q-px-md q-py-sm rounded-borders"},P=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Дата регистрации: ",-1),G={class:"text-1 text--style-3",style:{padding:"12px 0"}},F={class:"col-4"},O={class:"user-info__item q-px-md q-py-sm rounded-borders"},j=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Номер: ",-1),z={class:"text-1 text--style-3",style:{padding:"12px 0"}},B={class:"col-4"},K={class:"user-info__item q-px-md q-py-sm rounded-borders"},H=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Должность: ",-1),Y={key:0,class:"text-1 text--style-3",style:{padding:"12px 0"}},J={key:1,class:"text-1 text--style-3",style:{padding:"12px 0"}},X={key:0,class:"col-4"},ee={class:"user-info__item q-px-md q-py-sm rounded-borders"},te=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Должность резерва: ",-1),se={class:"text-1 text--style-3",style:{padding:"12px 0"}},ae={class:"col-4"},re={class:"user-info__item q-px-md q-py-sm rounded-borders"},le=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Департамент: ",-1),ie={class:"text-1 text--style-3",style:{padding:"12px 0"}},oe={class:"col-4"},ne={class:"user-info__item q-px-md q-py-sm rounded-borders"},me={class:"row items-center title-1 title--style-2 q-mb-xs"},de=(0,a.Uk)(" Email: "),ue={class:"text-1 text--style-3 q-mb-xs"},pe={class:"col-4"},ce={class:"user-info__item q-px-md q-py-sm rounded-borders"},_e={class:"title-1 title--style-2 q-mb-xs"},ge=(0,a.Uk)(" Префикс: "),he={key:1,class:"col-4"},ye={class:"user-info__item q-px-md q-py-sm rounded-borders"},fe=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Дата увольнения: ",-1),Ue={class:"text-1 text--style-3",style:{padding:"12px 0"}},we={class:"col-4"},ve={class:"user-info__item q-px-md q-py-sm rounded-borders"},be=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Дата введения в должность: ",-1),qe={key:0,class:"text-1 text--style-3",style:{padding:"12px 0"}},Ee={key:2,class:"col-4"},ke={class:"user-info__item q-px-md q-py-sm rounded-borders"},xe=(0,a.Uk)("Наставник"),Se=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Степень сотрудника: ",-1),Te={class:"text-1 text--style-3 q-mb-xs",style:{padding:"12px 0"}},Re={class:"q-my-lg"},We=(0,a._)("div",{class:"text-h6 q-mb-lg q-mt-lg"}," Действия ",-1),De={class:"row q-col-gutter-lg"},Ve={key:0,class:"col-6"},Ze={class:"user-info__item q-px-md q-py-sm rounded-borders"},Ie=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Резюме ",-1),Ce={class:"q-gutter-md q-my-md"},Ae={key:1,class:"col-6"},Me={class:"user-info__item q-px-md q-py-sm rounded-borders"},$e=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Загрузить резюме ",-1),Ne={class:"q-gutter-md q-my-md"},Qe=["value"],Le={key:2,class:"col-6"},Pe={class:"user-info__item q-px-md q-py-sm rounded-borders"},Ge={class:"title-1 title--style-2 q-mb-xs"},Fe={class:"q-gutter-md q-my-md"},Oe={key:3,class:"col-6"},je={class:"user-info__item q-px-md q-py-sm rounded-borders"},ze=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Введение в должность ",-1),Be={class:"q-gutter-md q-my-md"},Ke={class:"row items-center justify-end"},He={key:4,class:"col-6"},Ye={class:"user-info__item q-px-md q-py-sm rounded-borders"},Je=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"},"Увольнение сотрудника",-1),Xe={class:"q-gutter-md q-my-md"},et={class:"",style:{"max-width":"300px"}},tt={class:"row items-center justify-end"},st={key:5,class:"col-6"},at={class:"user-info__item q-px-md q-py-sm rounded-borders"},rt=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Загрузить скан паспорта ",-1),lt={class:"q-gutter-md q-my-md"},it=["value"],ot={key:6,class:"col-6"},nt={class:"user-info__item q-px-md q-py-sm rounded-borders"},mt=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Паспорт ",-1),dt={class:"q-gutter-md q-my-md"},ut={key:7,class:"col-6"},pt={class:"user-info__item q-px-md q-py-sm rounded-borders"},ct=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Смена должности ",-1),_t={class:"q-gutter-md q-my-md"},gt={class:"col-6"},ht={class:"user-info__item q-px-md q-py-sm rounded-borders"},yt=(0,a._)("p",{class:"title-1 title--style-2 q-mb-xs"}," Смена степени ",-1),ft={class:"q-gutter-md q-my-md"},Ut=(0,a._)("div",{class:"text-h6"},"Добавление в кадровый резерв",-1),wt=["value"],vt={class:"q-my-md"},bt={key:0,class:"q-my-md"},qt=(0,a._)("div",{class:"text-h6 q-mb-lg q-mt-lg"}," Виртуальный офис ",-1),Et={class:"row q-col-gutter-md justify-between"},kt={class:"col-6"},xt={class:"user-info__item q-px-md q-py-sm rounded-borders"},St={class:"title-1 title--style-2 p-relative q-mb-xs"},Tt=(0,a.Uk)(" Статус регистрации в ВО: "),Rt={key:0,class:"col-6"},Wt={class:"user-info__item q-px-md q-py-sm rounded-borders"},Dt=(0,a._)("p",{class:"title-1 title--style-2 p-relative q-mb-xs"},"Удаление пользователя",-1),Vt=(0,a._)("div",{class:"text-h6"},"Подтвердите действие",-1);function Zt(e,t,s,l,i,o){const n=(0,a.up)("q-icon"),m=(0,a.up)("q-input"),d=(0,a.up)("q-badge"),u=(0,a.up)("q-btn"),p=(0,a.up)("q-file"),c=(0,a.up)("q-form"),_=(0,a.up)("q-select"),g=(0,a.up)("q-date"),h=(0,a.up)("q-popup-proxy"),y=(0,a.up)("q-checkbox"),f=(0,a.up)("q-card-section"),U=(0,a.up)("q-card-actions"),w=(0,a.up)("q-card"),v=(0,a.up)("q-dialog"),b=(0,a.up)("DeleteUserBtn"),q=(0,a.Q2)("close-popup");return null!==i.user?((0,a.wg)(),(0,a.iD)("div",M,[$,(0,a._)("div",N,[(0,a._)("div",Q,[(0,a._)("div",L,[P,(0,a._)("p",G,(0,r.zw)(o.userRegistred),1)])]),(0,a._)("div",F,[(0,a._)("div",O,[j,(0,a._)("p",z,(0,r.zw)(o.phoneFormat),1)])]),(0,a._)("div",B,[(0,a._)("div",K,[H,"RESERVE"==o.targetUser.status?((0,a.wg)(),(0,a.iD)("p",Y,(0,r.zw)(o.targetUser.meta.reserve_position_name),1)):((0,a.wg)(),(0,a.iD)("p",J,(0,r.zw)(o.targetUser.position_name),1))])]),"INTERNAL_RESERVE"==o.targetUser.status?((0,a.wg)(),(0,a.iD)("div",X,[(0,a._)("div",ee,[te,(0,a._)("p",se,(0,r.zw)(o.targetUser.meta.reserve_position_name),1)])])):(0,a.kq)("",!0),(0,a._)("div",ae,[(0,a._)("div",re,[le,(0,a._)("p",ie,(0,r.zw)(o.targetUser.department),1)])]),(0,a._)("div",oe,[(0,a._)("div",ne,[(0,a._)("p",me,[de,(0,a.Wm)(n,{class:"q-ml-md pointer",name:"edit",onClick:t[0]||(t[0]=e=>i.form_state.email_editing=!1===i.form_state.email_editing)})]),(0,a._)("div",ue,[(0,a.Wm)(m,{modelValue:o.email,"onUpdate:modelValue":t[1]||(t[1]=e=>o.email=e),type:"text",label:"Email",disable:!i.form_state.email_editing},null,8,["modelValue","disable"])])])]),(0,a._)("div",pe,[(0,a._)("div",ce,[(0,a._)("p",_e,[ge,(0,a.Wm)(n,{class:"q-ml-md pointer",name:"edit",onClick:t[2]||(t[2]=e=>i.form_state.prefix_editing=!1===i.form_state.prefix_editing)})]),(0,a.Wm)(m,{modelValue:o.email_prefix,"onUpdate:modelValue":t[3]||(t[3]=e=>o.email_prefix=e),type:"text",label:"Префикс",disable:!i.form_state.prefix_editing},null,8,["modelValue","disable"])])]),o.targetUser.meta.fired_date&&"FIRED"===o.targetUser.status?((0,a.wg)(),(0,a.iD)("div",he,[(0,a._)("div",ye,[fe,(0,a._)("p",Ue,(0,r.zw)(o.targetUser.meta.fired_date),1)])])):(0,a.kq)("",!0),(0,a._)("div",we,[(0,a._)("div",ve,[be,o.targetUser.meta.position_date?((0,a.wg)(),(0,a.iD)("p",qe,(0,r.zw)(o.targetUser.meta.position_date),1)):(0,a.kq)("",!0)])]),o.targetUser.meta.position_category?((0,a.wg)(),(0,a.iD)("div",Ee,[(0,a._)("div",ke,[o.targetUser.meta.mentor?((0,a.wg)(),(0,a.j4)(d,{key:0,color:"positive"},{default:(0,a.w5)((()=>[xe])),_:1})):(0,a.kq)("",!0),Se,(0,a._)("p",Te,(0,r.zw)(o.targetUser.meta.position_category),1)])])):(0,a.kq)("",!0)]),(0,a._)("div",Re,[(0,a.Wm)(u,{color:"primary",label:"Сохранить","no-caps":"",onClick:o.updateUser,disable:!i.form_state.prefix_editing&&!i.form_state.email_editing},null,8,["onClick","disable"])]),We,(0,a._)("div",De,[o.hasResume?((0,a.wg)(),(0,a.iD)("div",Ve,[(0,a._)("div",Ze,[Ie,(0,a._)("div",Ce,[(0,a.Wm)(u,{target:"_blank",type:"a",color:"primary","no-caps":"",label:"Открыть резюме",href:o.docLink(this.targetUser.meta.resume)},null,8,["href"]),(0,a.Wm)(u,{target:"_blank",type:"a",color:"warning","no-caps":"",label:"Скачать резюме",href:this.targetUser.meta.resume},null,8,["href"]),(0,a.Wm)(u,{color:"negative",onClick:o.resumeDelete,target:"_blank",label:"Удалить резюме","no-caps":"",loading:i.form_state.loading},null,8,["onClick","loading"])])])])):"FIRED"!==this.targetUser.status?((0,a.wg)(),(0,a.iD)("div",Ae,[(0,a._)("div",Me,[$e,(0,a._)("div",Ne,[(0,a.Wm)(c,{onSubmit:o.resumeUpload,class:"q-gutter-md"},{default:(0,a.w5)((()=>[(0,a._)("input",{type:"hidden",name:"user_id",value:this.targetUser.id},null,8,Qe),(0,a.Wm)(p,{modelValue:i.form_data.resume,"onUpdate:modelValue":t[4]||(t[4]=e=>i.form_data.resume=e),name:"resume",label:"Резюме",rules:[e=>e||"Необходимо заполнить поле"]},null,8,["modelValue","rules"]),(0,a.Wm)(u,{color:"primary",type:"submit",label:"Сохранить",loading:i.form_state.loading,"no-caps":""},null,8,["loading"])])),_:1},8,["onSubmit"])])])])):(0,a.kq)("",!0),"FIRED"!==this.targetUser.status?((0,a.wg)(),(0,a.iD)("div",Le,[(0,a._)("div",Pe,[(0,a._)("p",Ge," Кадровый резерв "+(0,r.zw)(o.reservePositionName),1),(0,a._)("div",Fe,[o.targetUser.meta.reserve_position_crm_id?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,color:"primary",label:"Добавить в кадровый резерв","no-caps":"",onClick:t[5]||(t[5]=e=>i.form_state.personally_modal=!i.form_state.personally_modal)})),o.targetUser.meta.reserve_position_crm_id?((0,a.wg)(),(0,a.j4)(u,{key:1,color:"warning","no-caps":"",label:"Убрать с кадрового резерва",onClick:o.deleteUserMetaReserve,loading:this.form_state.loading},null,8,["onClick","loading"])):(0,a.kq)("",!0)])])])):(0,a.kq)("",!0),"EMPLOYEE"!==this.targetUser.status&&"INTERNAL_RESERVE"!==this.targetUser.status?((0,a.wg)(),(0,a.iD)("div",Oe,[(0,a._)("div",je,[ze,(0,a._)("div",Be,[(0,a.Wm)(_,{"emit-value":"",modelValue:i.employee_position_crm_id,"onUpdate:modelValue":t[6]||(t[6]=e=>i.employee_position_crm_id=e),options:this.positions,label:"Должность"},null,8,["modelValue","options"]),(0,a.Wm)(u,{color:"primary","no-caps":"",label:"Ввести в должность",onClick:o.userToEmployee},null,8,["onClick"])]),(0,a.Wm)(m,{filled:"",modelValue:i.position_date,"onUpdate:modelValue":t[8]||(t[8]=e=>i.position_date=e),mask:"date",rules:["date"],label:"Дата введения в должность"},{append:(0,a.w5)((()=>[(0,a.Wm)(n,{name:"event",class:"cursor-pointer"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:i.position_date,"onUpdate:modelValue":t[7]||(t[7]=e=>i.position_date=e)},{default:(0,a.w5)((()=>[(0,a._)("div",Ke,[(0,a.wy)((0,a.Wm)(u,{label:"Close",color:"primary",flat:""},null,512),[[q]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])):(0,a.kq)("",!0),"EMPLOYEE"===this.targetUser.status||"INTERNAL_RESERVE"===this.targetUser.status?((0,a.wg)(),(0,a.iD)("div",He,[(0,a._)("div",Ye,[Je,(0,a._)("div",Xe,[(0,a.Wm)(u,{color:"negative","no-caps":"",label:"Уволить сотрудника",onClick:o.employeeToFired},null,8,["onClick"]),(0,a._)("div",et,[(0,a.Wm)(m,{filled:"",modelValue:i.fired_date,"onUpdate:modelValue":t[10]||(t[10]=e=>i.fired_date=e),mask:"date",rules:["date"],label:"Дата увольнения"},{append:(0,a.w5)((()=>[(0,a.Wm)(n,{name:"event",class:"cursor-pointer"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:i.fired_date,"onUpdate:modelValue":t[9]||(t[9]=e=>i.fired_date=e)},{default:(0,a.w5)((()=>[(0,a._)("div",tt,[(0,a.wy)((0,a.Wm)(u,{label:"Close",color:"primary",flat:""},null,512),[[q]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])])])):(0,a.kq)("",!0),"undefined"===typeof this.targetUser.meta.passport?((0,a.wg)(),(0,a.iD)("div",st,[(0,a._)("div",at,[rt,(0,a._)("div",lt,[(0,a.Wm)(c,{onSubmit:o.passportUpload,class:"q-gutter-md"},{default:(0,a.w5)((()=>[(0,a._)("input",{type:"hidden",name:"user_id",value:this.targetUser.id},null,8,it),(0,a.Wm)(p,{modelValue:i.form_data.passport,"onUpdate:modelValue":t[11]||(t[11]=e=>i.form_data.passport=e),name:"passport",label:"Паспорт",rules:[e=>e||"Необходимо заполнить поле"]},null,8,["modelValue","rules"]),(0,a.Wm)(u,{color:"primary",type:"submit",label:"Сохранить",loading:i.form_state.loading,"no-caps":""},null,8,["loading"])])),_:1},8,["onSubmit"])])])])):"undefined"!==typeof this.targetUser.meta.passport?((0,a.wg)(),(0,a.iD)("div",ot,[(0,a._)("div",nt,[mt,(0,a._)("div",dt,[(0,a.Wm)(u,{target:"_blank",type:"a",color:"primary","no-caps":"",label:"Открыть",href:o.docLink(this.targetUser.meta.passport)},null,8,["href"]),(0,a.Wm)(u,{target:"_blank",type:"a",color:"warning","no-caps":"",label:"Скачать",href:this.targetUser.meta.passport},null,8,["href"]),(0,a.Wm)(u,{color:"negative",onClick:o.passportDelete,target:"_blank",label:"Удалить","no-caps":"",loading:i.form_state.loading},null,8,["onClick","loading"])])])])):(0,a.kq)("",!0),"EMPLOYEE"===this.targetUser.status?((0,a.wg)(),(0,a.iD)("div",ut,[(0,a._)("div",pt,[ct,(0,a._)("div",_t,[(0,a.Wm)(_,{"emit-value":"",modelValue:i.employee_position_crm_id,"onUpdate:modelValue":t[12]||(t[12]=e=>i.employee_position_crm_id=e),options:this.positions,label:"Должность"},null,8,["modelValue","options"]),(0,a.Wm)(u,{color:"primary","no-caps":"",label:"Сменить должность",onClick:o.userToEmployee},null,8,["onClick"])])])])):(0,a.kq)("",!0),(0,a._)("div",gt,[(0,a._)("div",ht,[yt,(0,a._)("div",ft,[(0,a.Wm)(_,{"emit-value":"",modelValue:i.position_category,"onUpdate:modelValue":t[13]||(t[13]=e=>i.position_category=e),options:[1,2,3,4],label:"Категория"},null,8,["modelValue"]),(0,a.Wm)(y,{"left-label":"",label:"Наставник",modelValue:o.isMentor,"onUpdate:modelValue":t[14]||(t[14]=e=>o.isMentor=e)},null,8,["modelValue"]),(0,a.Wm)(u,{color:"primary","no-caps":"",label:"Сохранить",onClick:o.updateCategory},null,8,["onClick"])])])])]),(0,a.Wm)(v,{modelValue:i.form_state.personally_modal,"onUpdate:modelValue":t[17]||(t[17]=e=>i.form_state.personally_modal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[Ut])),_:1}),(0,a.Wm)(f,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"q-gutter-md",style:{"min-width":"500px"},onSubmit:o.updateUserMetaFormData},{default:(0,a.w5)((()=>[(0,a._)("input",{type:"hidden",name:"user_id",value:this.targetUser.id},null,8,wt),(0,a._)("div",vt,[(0,a.Wm)(_,{modelValue:i.form_data.reserve_position_crm_id,"onUpdate:modelValue":t[15]||(t[15]=e=>i.form_data.reserve_position_crm_id=e),"emit-value":"",options:this.positions,name:"reserve_position_crm_id",label:"Должность",rules:[e=>e||"Необходимо заполнить поле"]},null,8,["modelValue","options","rules"])]),"CANDIDATE"===o.targetUser.status?((0,a.wg)(),(0,a.iD)("div",bt,[(0,a.Wm)(_,{modelValue:i.form_data.reserve_prioricy,"onUpdate:modelValue":t[16]||(t[16]=e=>i.form_data.reserve_prioricy=e),name:"reserve_prioricy",options:[1,2,3],label:"Приоритет",rules:[e=>e||"Необходимо заполнить поле"]},null,8,["modelValue","rules"])])):(0,a.kq)("",!0),(0,a.Wm)(U,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{label:"Добавить",type:"submit",color:"primary",loading:this.form_state.loading},null,8,["loading"]),(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Отменить",color:"primary"},null,512),[[q]])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),qt,(0,a._)("div",Et,[(0,a._)("div",kt,[(0,a._)("div",xt,[(0,a._)("p",St,[Tt,(0,a.Wm)(d,{color:o.statusInterpreter.color,floating:"",transparent:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(o.statusInterpreter.message),1)])),_:1},8,["color"])]),"UNDEFINED"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"q-mt-md q-mb-md",color:"primary",label:"Проверить пользователя",onClick:o.checkUserInVo},null,8,["onClick"])):"UNREGISTERED"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(u,{key:1,class:"q-mt-md q-mb-md",color:"primary",label:"Зарегистрировать пользователя в ВО",onClick:o.registrationUserInVo},null,8,["onClick"])):"REGISTRED_LIKE_MANAGER"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(u,{key:2,class:"q-mt-md q-mb-md",color:"primary",label:"Первести в статус пользователя",onClick:t[18]||(t[18]=e=>i.modal=!0)})):"REGISTRED_LIKE_USER"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(u,{key:3,class:"q-mt-md q-mb-md",label:"Перевести в статус менеджера",color:"primary",onClick:o.userToManager},null,8,["onClick"])):(0,a.kq)("",!0)])]),"CANDIDATE"===o.targetUser.status?((0,a.wg)(),(0,a.iD)("div",Rt,[(0,a._)("div",Wt,[Dt,(0,a.Wm)(b)])])):(0,a.kq)("",!0)]),(0,a.Wm)(v,{modelValue:i.modal,"onUpdate:modelValue":t[19]||(t[19]=e=>i.modal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[Vt])),_:1}),"UNREGISTERED"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(f,{key:0,class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Uk)(' Вы уверены что хотите зарегистрировать пользователя под именем: "'+(0,r.zw)(`${this.targetUser.family} ${this.targetUser.name} ${this.targetUser.middle_name}`)+'" как менджера в виртуальном офисе? ',1)])),_:1})):"REGISTRED_LIKE_MANAGER"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(f,{key:1,class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Uk)(' Вы уверены что хотите перевести менеджера под именем: "'+(0,r.zw)(`${this.targetUser.family} ${this.targetUser.name} ${this.targetUser.middle_name}`)+'" в статус пользователя в виртуальном офисе? ',1)])),_:1})):(0,a.kq)("",!0),"UNREGISTERED"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(U,{key:2,align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Зарегистрировать",color:"primary"},null,512),[[q]]),(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Отменить",color:"primary"},null,512),[[q]])])),_:1})):"REGISTRED_LIKE_MANAGER"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(U,{key:3,align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{flat:"",label:"Перевести в статус пользователя",color:"primary",onClick:o.managerToUser},null,8,["onClick"]),(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Отменить",color:"primary"},null,512),[[q]])])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1},8,["modelValue"])])):(0,a.kq)("",!0)}s(9544);var It=s(4429),Ct=s(4434);const At=(0,a._)("div",{class:"text-h6"},"Подтвердите действие",-1);function Mt(e,t,s,l,i,o){const n=(0,a.up)("q-btn"),m=(0,a.up)("q-card-section"),d=(0,a.up)("q-card-actions"),u=(0,a.up)("q-card"),p=(0,a.up)("q-dialog"),c=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,["REGISTRED_LIKE_USER"===this.targetUserVoStatus||"UNREGISTERED"===this.targetUserVoStatus?((0,a.wg)(),(0,a.j4)(n,{key:0,color:"negative",label:"Удалить пользователя",onClick:t[0]||(t[0]=e=>this.modal=!0)})):(0,a.kq)("",!0),(0,a.Wm)(p,{modelValue:i.modal,"onUpdate:modelValue":t[1]||(t[1]=e=>i.modal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[At])),_:1}),(0,a.Wm)(m,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Uk)(' Вы уверены что хотите удалить пользователя под именем: "'+(0,r.zw)(`${this.targetUser.family} ${this.targetUser.name} ${this.targetUser.middle_name}`)+'"? После удаления все данные связанные с данным пользователем будут удалены! ',1)])),_:1}),(0,a.Wm)(d,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{flat:"",label:"Удалить",color:"negative",onClick:o.deleteUser},null,8,["onClick"]),(0,a.wy)((0,a.Wm)(n,{flat:"",label:"Отменить",color:"primary"},null,512),[[c]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const $t={data(){return{modal:!1}},methods:{deleteUser(){C.Zm.deleteUser(this.targetUser.id).then((e=>{this.$router.push("/admin/users/user")}))}},computed:{...(0,A.Se)("user",["targetUser","targetUserVoStatus"])}};var Nt=s(8240),Qt=s(6778),Lt=s(9367),Pt=s(677);$t.render=Mt;const Gt=$t;T()($t,"components",{QBtn:Nt.Z,QDialog:Qt.Z,QCard:w.Z,QCardSection:k.Z,QCardActions:Lt.Z}),T()($t,"directives",{ClosePopup:Pt.Z});const Ft={data(){return{modal:!1,user:null,form_data:{},form_state:{email_editing:!1,prefix_editing:!1,has_changes:!1,loading:!1,personally_modal:!1},employee_position_crm_id:null,positions:[],fired_date:null,position_date:null,position_category:null}},components:{DeleteUserBtn:Gt},methods:{...(0,A.nv)("user",["targetUserSet","targetUserSetMeta","positionsLoad"]),checkUserInVo(){C.Zm.vo.findUserByPhone(this.targetUser.phone).then((e=>{"error"===e.data.status?C.Zm.updateUserMeta(this.targetUser.id,{vo_status:"UNREGISTERED"}).then((e=>{this.targetUserSetMeta(JSON.parse(e.data.meta))})):"success"===e.data.status&&C.Zm.updateUserMeta(this.targetUser.id,{vo_status:"REGISTRED_LIKE_MANAGER",vo_id:e.data.response.ID}).then((e=>{this.targetUserSetMeta(JSON.parse(e.data.meta))}))}))},registrationUserInVo(){let e={phone:this.targetUser.phone,first_name:this.targetUser.name,last_name:this.targetUser.family,middle_name:this.targetUser.middle_name,password:this.targetUser.meta.password};C.Zm.vo.registrationUser(e).then((e=>{"success"===e.data.status&&C.Zm.updateUserMeta(this.targetUser.id,{vo_status:"REGISTRED_LIKE_MANAGER",vo_id:e.data.response.user_id}).then((e=>{this.targetUserSetMeta(JSON.parse(e.data.meta))}))}))},managerToUser(){C.Zm.vo.managerToUser(this.targetUser.meta.vo_id).then((e=>{"success"===e.data.status&&C.Zm.updateUserMeta(this.targetUser.id,{vo_status:"REGISTRED_LIKE_USER"}).then((e=>{this.targetUserSetMeta(JSON.parse(e.data.meta)),this.modal=!1}))}))},userToManager(){C.Zm.vo.userToManager(this.targetUser.meta.vo_id).then((e=>{"success"===e.data.status&&C.Zm.updateUserMeta(this.targetUser.id,{vo_status:"REGISTRED_LIKE_MANAGER",vo_id:e.data.response.user_id}).then((e=>{this.targetUserSetMeta(JSON.parse(e.data.meta)),this.modal=!1}))}))},deleteUser(){C.Zm.vo.deleteUser(this.targetUser.meta.vo_id).then((e=>{"success"===e.data.status&&C.Zm.updateUserMeta(this.targetUser.id,{vo_status:"DELETED"}).then((e=>{this.targetUserSetMeta(JSON.parse(e.data.meta))}))}))},updateCategory(){null==this.targetUser.email||null==this.targetUser.email_prefix||null==this.targetUser.position_crm_id?Ct.Z.create({type:"negative",message:"Не заполнен email или префикс или должность."}):null!==this.position_category?C.Zm.updateUserMeta(this.targetUser.id,{position_category:this.position_category,mentor:this.isMentor}).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})):Ct.Z.create({type:"negative",message:"Выберите категорию сотрудника."})},updateUser(){this.form_state.loading=!0,(0,It.Bm)("api/users",{user_id:this.targetUser.id,email:this.email,email_prefix:this.email_prefix}).then((e=>{this.form_state.email_editing=!1,this.form_state.prefix_editing=!1,this.form_state.has_changes=!1,console.log(e)})).finally((()=>{this.form_state.loading=!1}))},userToEmployee(){"EMPLOYEE"===this.targetUser.status||this.targetUser.meta.passport&&this.targetUser.meta.resume?null==this.targetUser.email||null==this.targetUser.email_prefix?Ct.Z.create({type:"negative",message:"Не заполнен email или префикс."}):(0,It.CU)("api/user-to-employee",{user_id:this.targetUser.id,position_crm_id:this.employee_position_crm_id,position_date:this.position_date}).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})):Ct.Z.create({type:"negative",message:"Кажется незагружен скан паспорта или резюме."})},employeeToFired(){(0,It.CU)("api/employee-to-fired",{user_id:this.targetUser.id,fired_date:this.fired_date}).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data),this.targetUser.meta.vo_id&&this.managerToUser()}))},updateUserMetaFormData(e){if(this.form_state.loading=!0,e.preventDefault(),this.targetUser.meta.resume||"CANDIDATE"!==this.targetUser.status){let t=e.target,s=new FormData(t);C.Zm.updateUserMetaFormData(this.targetUser.id,s).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})).finally((()=>{this.form_state.personally_modal=!1,this.form_state.loading=!1}))}else Ct.Z.create({type:"negative",message:"Для начала, загрузите резюме."}),this.form_state.personally_modal=!1,this.form_state.loading=!1},deleteUserMetaReserve(){this.form_state.loading=!0,(0,It.fH)(`api/user-meta-reserve/${this.targetUser.id}`).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})).finally((()=>{this.form_state.loading=!1}))},resumeUpload(e){this.form_state.loading=!0,e.preventDefault();let t=e.target,s=new FormData(t);(0,It.CU)("api/user-resume-upload",s).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})).finally((()=>{this.form_state.loading=!1}))},resumeDelete(){this.form_state.loading=!0,(0,It.fH)(`api/user-resume-delete/${this.targetUser.id}`).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})).finally((()=>{this.form_state.loading=!1}))},passportUpload(e){this.form_state.loading=!0,e.preventDefault();let t=e.target,s=new FormData(t);(0,It.CU)("api/user-passport-upload",s).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})).finally((()=>{this.form_state.loading=!1}))},passportDelete(){this.form_state.loading=!0,(0,It.fH)(`api/user-passport-delete/${this.targetUser.id}`).then((e=>{this.$store.commit("user/SET_TARGET_USER",e.data)})).finally((()=>{this.form_state.loading=!1}))},docLink(e){return"undefined"!==typeof e?"https://docs.google.com/gview?url="+e+"&embedded=true":""}},computed:{...(0,A.Se)("user",["getUser","targetUser","isLeader","targetUserVoStatus","getToken"]),email:{get(){return this.$store.state.user.targetUser.email},set(e){this.$store.commit("user/SET_TARGET_USER_EMAIL",e)}},email_prefix:{get(){return this.$store.state.user.targetUser.email_prefix},set(e){this.$store.commit("user/SET_TARGET_USER_EMAIL_PREFIX",e)}},userRegistred:{get(){return I.Z.dateFormat(this.user.created_at)}},targetUser:{get(){return this.$store.state.user.targetUser}},isMentor:{get(){return this.$store.state.user.targetUser.meta.mentor,Boolean(this.$store.state.user.targetUser.meta.mentor)},set(e){this.$store.commit("user/SET_TARGET_USER_META_INNER",{key:"mentor",value:e})}},statusInterpreter(){switch(this.targetUserVoStatus){case"UNREGISTERED":return{message:"Не зарегистрирован",color:"negative"};case"REGISTRED_LIKE_MANAGER":return{message:"Зарегистрирован",color:"positive"};case"DELETED":return{message:"Удален",color:"negative"};case"REGISTRED_LIKE_USER":return{message:"Зарег. как пользователь",color:"warning"};default:return{message:"Не определён",color:"warning"}}},phoneFormat(){return I.Z.phoneFormat(this.user.phone)},emailFormat(){return null!=this.user.email?this.user.email:"Email не указан"},hasResume(){return"undefined"!==typeof this.targetUser.meta.resume},reservePositionName(){return"undefined"!==typeof this.targetUser.meta.reserve_position_crm_id&&this.positions.length>0?`(${this.positions.find((e=>e.value==this.targetUser.meta.reserve_position_crm_id)).label})`:null}},async mounted(){null===this.user&&(this.user=this.targetUser),this.positionsLoad().then((e=>{let t=e.data;t.forEach((e=>{let t={label:e.name,value:e.crm_id};this.positions.push(t)}))})).catch((e=>{console.log(e)}))}};var Ot=s(4554),jt=s(4689),zt=s(9721),Bt=s(5269),Kt=s(4974),Ht=s(7757),Yt=s(3944),Jt=s(5836),Xt=s(6271);Ft.render=Zt;const es=Ft;T()(Ft,"components",{QIcon:Ot.Z,QInput:jt.Z,QBadge:zt.Z,QBtn:Nt.Z,QForm:Bt.Z,QFile:Kt.Z,QSelect:Ht.Z,QPopupProxy:Yt.Z,QDate:Jt.Z,QCheckbox:Xt.Z,QDialog:Qt.Z,QCard:w.Z,QCardSection:k.Z,QCardActions:Lt.Z}),T()(Ft,"directives",{ClosePopup:Pt.Z});const ts={key:0},ss=(0,a._)("div",{class:"text-h6 q-mb-lg"}," Результаты пройденых тестов ",-1),as={class:"absolute-bottom"},rs={class:"text-subtitle2"},ls={class:"text-h6 q-mt-sm q-mb-xs"},is=["innerHTML"];function os(e,t,s,l,i,o){const n=(0,a.up)("q-img"),m=(0,a.up)("q-badge"),d=(0,a.up)("q-card-section"),u=(0,a.up)("q-card");return null!==e.getTargetUserTests?((0,a.wg)(),(0,a.iD)("div",ts,[ss,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.getTargetUserTests,(e=>((0,a.wg)(),(0,a.j4)(u,{class:"my-card q-mb-md",key:e},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{horizontal:"",class:"row"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{class:"col col-sm-3",src:e.image},{default:(0,a.w5)((()=>[(0,a._)("div",as,[(0,a._)("div",rs,(0,r.zw)(e.name),1)])])),_:2},1032,["src"]),(0,a.Wm)(d,{class:"col-12 col-sm-9"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"p-0"},{default:(0,a.w5)((()=>[(0,a._)("div",ls,[(0,a.Uk)(' Результаты теста: "'+(0,r.zw)(e.name)+'" ',1),(0,a.Wm)(m,{color:o.testStatus(e.status).color,floating:"",transparent:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(o.testStatus(e.status).message),1)])),_:2},1032,["color"])]),(0,a._)("div",{class:"text-caption text-grey",innerHTML:o.testResult(e)},null,8,is)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])):(0,a.kq)("",!0)}const ns={methods:{testStatus(e){return Z.Z.testStatus(e)},testResult(e){return Z.Z.testResult(e)}},computed:{...(0,A.Se)("tests",["getTargetUserTests"])}};var ms=s(4152);ns.render=os;const ds=ns;T()(ns,"components",{QCard:w.Z,QCardSection:k.Z,QImg:ms.Z,QBadge:zt.Z});s(9441);const us={data(){return{attestations:null,attestation:null,user:null,tests:null,mapTest:null,archiveTests:null,tab:(0,u.iH)("tests")}},components:{TabInfo:es,TabTestsResult:ds,UserInfoSkeleton:R,TableInfoSkeleton:V},methods:{...(0,A.nv)("user",["targetUserSet","targetUserUnset","positionsLoad"]),...(0,A.nv)("tests",["userTestUpdate","targetUserTestsInit","targetUserTestsNull"]),testStatus(e){let t={};return"PASSED"===e?(t.message="Тест пройден!",t.color="positive"):"FAILED"===e?(t.message="Тест не пройден!",t.color="negative"):(t.message="Необходимо пройти тест!",t.color="secondary"),t},testResult(e){return Z.Z.testResult(e)},async getUserInfo(){return new Promise(((e,t)=>{d.api.get(`/api/users/${this.$route.params.id}`).then((t=>{200!==t.status&&201!==t.status||(this.user=t.data,this.targetUserSet(this.user),e(t))})).catch((e=>{t(e)}))}))},async getUserTests(){return new Promise(((e,t)=>{d.api.get(`/api/testsMerged/${this.$route.params.id}`).then((t=>{200!==t.status&&201!==t.status||(this.tests=t.data.merged_tests,this.tests.map((e=>{e.test_id=e.id,e.status=Z.Z.testsResultStatus(e)})),this.tests.forEach((e=>{5===e.id&&(this.mapTest=e)})),this.mapTest.value&&(this.mapTest.value=JSON.parse(this.mapTest.value)),this.attestation=t.data.attestation,this.targetUserTestsInit(this.tests),e(t))})).catch((e=>{t(e)}))}))},async geteArchiveUserTests(e){return new Promise(((t,s)=>{d.api.get(`/api/attestationsArchiveTests/${e}`).then((e=>{200!==e.status&&201!==e.status||t(e)})).catch((e=>{s(e)}))}))},async geteUserAttestations(){return new Promise(((e,t)=>{d.api.get(`/api/usersAttestations/${this.$route.params.id}`).then((t=>{200!==t.status&&201!==t.status||(this.attestations=t.data,e(t))})).catch((e=>{t(e)}))}))},attestationTests(e){this.attestations&&this.attestations.map(((t,s)=>{t.id!=e||this.attestations[s].tests||this.geteArchiveUserTests(e).then((e=>{let t=e.data;t.map(((e,t)=>{let s,a=e.test_id;this.tests.forEach((e=>{e.id==a&&(s=e)})),e.name=s.name,e.slug=s.slug})),this.attestations[s].tests=e.data}))}))},saveMapTest(){this.userTestUpdate(this.mapTest)},dateFormat(e){return I.Z.dateFormat(e)},attestationPositionName(e){let t=this.$store.state.user.positions.find((t=>t.crm_id==e.position_crm_id));if("undefined"!==typeof t)return`(на должность: ${t.name})`}},mounted(){this.getUserInfo(),this.getUserTests().then((e=>{this.attestations=this.geteUserAttestations()})),null==this.user&&(this.user=this.getUser),this.$store.state.user.positions||this.positionsLoad()},unmounted(){this.targetUserUnset(),this.targetUserTestsNull()},computed:{...(0,A.Se)("user",["getUser","targetUser","isLeader","targetUserVoStatus"]),firstLetterName(){return null!==this.user?this.user.name.substr(0,1).toUpperCase():""},phoneFormat(){return I.Z.phoneFormat(this.user.phone)},emailFormat(){return null!=this.targetUser.email?this.targetUser.email:"Email не указан"},attestationStatus(){return null!==this.attestation&&this.attestation.status},userMainStatusText(){return null!==this.targetUser?(0,C.$5)(this.user.status):""},userSubStatusText(){return null!==this.targetUser?(0,C.tB)(this.user.status):""},userStatusColor(){return null!==this.targetUser?(0,C.xS)(this.user.status):""}}};var ps=s(5096),cs=s(7547),_s=s(8408),gs=s(5906),hs=s(6602),ys=s(7011),fs=s(429);us.render=m;const Us=us;T()(us,"components",{QCard:w.Z,QItem:v.Z,QItemSection:b.Z,QAvatar:ps.Z,QItemLabel:E.Z,QBadge:zt.Z,QCardSection:k.Z,QTabs:cs.Z,QTab:_s.Z,QSeparator:x.Z,QTabPanels:gs.Z,QTabPanel:hs.Z,QList:ys.Z,QCheckbox:Xt.Z,QBtn:Nt.Z,QExpansionItem:fs.Z})}}]);