"use strict";(self["webpackChunkquasar_app"]=self["webpackChunkquasar_app"]||[]).push([[832],{1327:(e,s,t)=>{t.d(s,{tC:()=>m,xO:()=>l});var r=t(7083),a=t(52),n=t.n(a),i=(t(3459),t(5343)),o=t(8669),u=t(4434);const l={token:"$P$ByJtUe8KliwKh9WNUDkZFpsvJfm5K11"},m=n().create({baseURL:"https://vo.qb2b.ru",withCredentials:!0});m.interceptors.request.use((e=>{let s=localStorage.getItem("token");return s&&(e.headers["Authorization"]=`Bearer ${s}`),e}),(e=>Promise.reject(e))),m.interceptors.response.use((e=>(e.data.message&&u.Z.create({type:"positive",message:e.data.message}),e)),(e=>(401===e.response.status&&(e.response.message&&u.Z.create({type:"negative",message:e.response.message}),i["default"].dispatch("user/clearStorage"),o.Z.go("/login")),e)));(0,r.xr)((({app:e})=>{e.config.globalProperties.$axios=n(),e.config.globalProperties.$api=m}))},8300:(e,s,t)=>{t.d(s,{Zm:()=>n,$5:()=>i,tB:()=>o,xS:()=>u});var r=t(5474),a=t(1327);const n={async updateUserMeta(e,s){return s.user_id=e,new Promise(((e,t)=>{r.api.post("/api/updateUserMeta",s).then((s=>e(s))).catch((e=>t(e)))}))},async updateUserMetaFormData(e,s){return s.user_id=e,new Promise(((e,t)=>{r.api.post("/api/user-meta-reserve",s).then((s=>e(s))).catch((e=>t(e)))}))},async deleteUser(e){return new Promise(((s,t)=>{r.api["delete"]("/api/users/"+e).then((e=>s(e))).catch((e=>t(e)))}))},vo:{async findUserByPhone(e){return a.xO.method="find-user-by-phone",a.xO.phone=e,new Promise(((e,s)=>{a.tC.post("/api/",a.xO).then((s=>e(s))).catch((e=>s(e)))}))},async registrationUser(e){return a.xO.method="create-user",a.xO.phone=e.phone,a.xO.first_name=e.first_name,a.xO.last_name=e.last_name,a.xO.middle_name=e.middle_name,a.xO.password=e.password,new Promise(((e,s)=>{a.tC.post("/api/",a.xO).then((s=>e(s))).catch((e=>s(e)))}))},async deleteUser(e){return a.xO.method="delete-user",a.xO.user_vo_id=e,new Promise(((e,s)=>{a.tC.post("/api/",a.xO).then((s=>e(s))).catch((e=>s(e)))}))},async managerToUser(e){return a.xO.method="manager-to-user",a.xO.user_vo_id=e,new Promise(((e,s)=>{a.tC.post("/api/",a.xO).then((s=>e(s))).catch((e=>s(e)))}))},async userToManager(e){return a.xO.method="user-to-manager",a.xO.user_vo_id=e,new Promise(((e,s)=>{a.tC.post("/api/",a.xO).then((s=>e(s))).catch((e=>s(e)))}))}}},i=e=>{let s="";switch(e){case"EMPLOYEE":s="Сотрудник";break;case"CANDIDATE":s="Пользователь";break;case"RESERVE":s="Пользователь";break;case"INTERNAL_RESERVE":s="Сотрудник";break;case"FIRED":s="Уволен";break}return s},o=e=>{let s="";switch(e){case"EMPLOYEE":s="";break;case"CANDIDATE":s="";break;case"RESERVE":s="Кадровый резерв";break;case"INTERNAL_RESERVE":s="Внутренний кадровый резерв";break;case"FIRED":s="";break}return s},u=e=>{let s="";switch(e){case"EMPLOYEE":s="positive";break;case"CANDIDATE":s="warning";break;case"RESERVE":s="warning";break;case"INTERNAL_RESERVE":s="warning";break;case"FIRED":s="negative";break}return s}},9832:(e,s,t)=>{t.r(s),t.d(s,{default:()=>O});var r=t(3673);const a={key:0,class:"skeleton-wrapper"},n={key:1},i={key:2};function o(e,s,t,o,u,l){const m=(0,r.up)("UserCardSkeleton"),p=(0,r.up)("UserCard"),d=(0,r.up)("q-expansion-item"),c=(0,r.up)("q-list");return(0,r.wg)(),(0,r.iD)(r.HY,null,[null===u.users?((0,r.wg)(),(0,r.iD)("div",a,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(u.skeletons,(e=>((0,r.wg)(),(0,r.j4)(m,{key:e})))),128))])):(0,r.kq)("",!0),"personnel-reserve"===this.$route.name?((0,r.wg)(),(0,r.iD)("div",n,[(0,r.Wm)(c,{padding:"",class:"menu-list"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(u.reserve_users,((e,s)=>((0,r.wg)(),(0,r.j4)(d,{key:s,label:s,"content-inset-level":1},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e,(e=>((0,r.wg)(),(0,r.j4)(p,{fullName:e.family+" "+e.name+" "+e.middle_name,userRole:e.role,userStatus:e.status,userPosition:e.position.name,"user-id":e.id,badgeInfo:`Приоритет: ${e.meta.reserve_prioricy}`,key:e},null,8,["fullName","userRole","userStatus","userPosition","user-id","badgeInfo"])))),128))])),_:2},1032,["label"])))),128))])),_:1})])):((0,r.wg)(),(0,r.iD)("div",i,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(u.users,(e=>((0,r.wg)(),(0,r.j4)(p,{fullName:e.family+" "+e.name+" "+e.middle_name,userRole:e.role,userStatus:e.status,userPosition:e.position.name,"user-id":e.id,key:e},null,8,["fullName","userRole","userStatus","userPosition","user-id"])))),128))]))],64)}t(7098);var u=t(2323);function l(e,s,t,a,n,i){const o=(0,r.up)("q-avatar"),l=(0,r.up)("q-item-section"),m=(0,r.up)("q-item-label"),p=(0,r.up)("q-badge"),d=(0,r.up)("q-item"),c=(0,r.up)("q-card"),h=(0,r.Q2)("ripple");return(0,r.wg)(),(0,r.j4)(c,{class:"my-card q-mb-sm",flat:"",bordered:""},{default:(0,r.w5)((()=>[(0,r.wy)((0,r.Wm)(d,{clickable:"",to:{name:"users-info",params:{id:t.userId}}},{default:(0,r.w5)((()=>[(0,r.Wm)(l,{avatar:""},{default:(0,r.w5)((()=>[(0,r.Wm)(o,{color:"secondary","text-color":"white"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,u.zw)(i.firstLetterName),1)])),_:1})])),_:1}),(0,r.Wm)(l,null,{default:(0,r.w5)((()=>[(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,u.zw)(t.fullName),1)])),_:1}),(0,r.Wm)(m,{caption:""},{default:(0,r.w5)((()=>[(0,r.Uk)((0,u.zw)(t.userRole),1)])),_:1})])),_:1}),(0,r.Wm)(l,null,{default:(0,r.w5)((()=>[t.userStatus?((0,r.wg)(),(0,r.j4)(m,{key:0,caption:""},{default:(0,r.w5)((()=>[(0,r.Uk)((0,u.zw)(i.userMainStatusText),1)])),_:1})):(0,r.kq)("",!0),t.userPosition?((0,r.wg)(),(0,r.j4)(m,{key:1,caption:""},{default:(0,r.w5)((()=>[(0,r.Uk)((0,u.zw)(t.userPosition),1)])),_:1})):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(l,{style:{position:"relative"}},{default:(0,r.w5)((()=>[t.badgeInfo?((0,r.wg)(),(0,r.j4)(p,{key:0,color:"secondary",floating:"",transparent:"",label:t.badgeInfo},null,8,["label"])):(0,r.kq)("",!0)])),_:1})])),_:1},8,["to"]),[[h]])])),_:1})}var m=t(8300);const p={props:{fullName:String,userRole:String,userId:Number,badgeInfo:String,userStatus:String,userPosition:String},computed:{firstLetterName(){return this.fullName.substr(0,1).toUpperCase()},userMainStatusText(){return(0,m.$5)(this.userStatus)}}};var d=t(151),c=t(3414),h=t(2035),w=t(5096),_=t(2350),g=t(9721),f=t(6489),v=t(7518),k=t.n(v);p.render=l;const y=p;function b(e,s,t,a,n,i){const o=(0,r.up)("q-skeleton"),u=(0,r.up)("q-item-section"),l=(0,r.up)("q-item-label"),m=(0,r.up)("q-item"),p=(0,r.up)("q-card");return(0,r.wg)(),(0,r.j4)(p,{class:"my-card q-mb-sm",flat:"",bordered:""},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{style:{"max-width":"250px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{avatar:""},{default:(0,r.w5)((()=>[(0,r.Wm)(o,{type:"QAvatar"})])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(l,null,{default:(0,r.w5)((()=>[(0,r.Wm)(o,{type:"text"})])),_:1}),(0,r.Wm)(l,{caption:""},{default:(0,r.w5)((()=>[(0,r.Wm)(o,{type:"text",width:"65%"})])),_:1})])),_:1})])),_:1})])),_:1})}k()(p,"components",{QCard:d.Z,QItem:c.Z,QItemSection:h.Z,QAvatar:w.Z,QItemLabel:_.Z,QBadge:g.Z}),k()(p,"directives",{Ripple:f.Z});const E={};var x=t(4103);E.render=b;const P=E;k()(E,"components",{QCard:d.Z,QItem:c.Z,QItemSection:h.Z,QSkeleton:x.ZP,QItemLabel:_.Z});var S=t(5474),U=t(3617);const R={data(){return{users:null,reserve_users:{},skeletons:10}},components:{UserCard:y,UserCardSkeleton:P},methods:{...(0,U.nv)("user",["positionsLoad"]),async getAllUsers(){return new Promise(((e,s)=>{S.api.get(`/api/users?users_list_type=${this.$route.name}`).then((s=>{200!==s.status&&201!==s.status||(this.users=s.data,e(s))})).catch((e=>{s(e)}))}))},sortUsersByPositions(){this.$store.state.user.positions?this.getAllUsers().then((e=>{if("personnel-reserve"===this.$route.name){this.reserve_users={},this.users.sort(((e,s)=>e.meta.reserve_prioricy>s.meta.reserve_prioricy?1:-1));for(let e=0;e<this.users.length;e++){let s=this.users[e],t=this.$store.state.user.positions.find((e=>e.crm_id==s.meta.reserve_position_crm_id)).name;"undefined"===typeof this.reserve_users[t]?this.reserve_users[t]=[s]:this.reserve_users[t].push(s)}}})):this.positionsLoad().then((e=>{console.log(e),this.getAllUsers().then((e=>{if("personnel-reserve"===this.$route.name){this.reserve_users={},this.users.sort(((e,s)=>e.meta.reserve_prioricy>s.meta.reserve_prioricy?1:-1));for(let e=0;e<this.users.length;e++){let s=this.users[e],t=this.$store.state.user.positions.find((e=>e.crm_id==s.meta.reserve_position_crm_id)).name;"undefined"===typeof this.reserve_users[t]?this.reserve_users[t]=[s]:this.reserve_users[t].push(s)}}}))}))}},computed:{},watch:{"$route.path"(){this.users=null,this.sortUsersByPositions()}},mounted(){"personnel-reserve"===this.$route.name?this.sortUsersByPositions():this.getAllUsers()}};var I=t(7011),q=t(429);R.render=o;const O=R;k()(R,"components",{QList:I.Z,QExpansionItem:q.Z})}}]);