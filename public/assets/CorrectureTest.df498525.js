import{_,K as c,L as o,a3 as l,S as d,T as p,ac as g,ad as a,R as S,a9 as x,ab as T,J as k,O as y}from"./index.9eb2ac42.js";const b={data(){return{count:0,ABC:"\u0430 \u0431 \u0432 \u0433 \u0434 \u0435 \u0451 \u0436 \u0437 \u0438 \u0439 \u043A \u043B \u043C \u043D \u043E \u043F \u0440 \u0441 \u0442 \u0443 \u0444 \u0445 \u0446 \u0447 \u0448 \u0449 \u044A \u044B \u044C \u044D \u044E \u044F"}},props:{symbols:Number,modulo:Number,currentTime:Number,generated:Array,checked:Array},emits:["generated-push","checked-push","checked-unset","check-missed","start-timer"],methods:{symbolGenrator:function(){let e=this.ABC.split(" ");for(let t=0;t<this.symbols;t++){let s=e[Math.floor(Math.random()*e.length)];this.$emit("generated-push",s)}this.$emit("start-timer")},symbolCheck:function(e){if(this.currentTime>0){let t=e.target,s=parseInt(t.dataset.index);this.modulo===0&&this.$emit("start-timer"),this.checked.indexOf(s)===-1?(this.$emit("checked-push",s),t.classList.add("active")):this.$emit("checked-unset",[t,s]),this.$emit("check-missed",s)}}}},I={class:"buttons-wrap"},A={class:"flex-container"},N=["data-index"];function O(e,t,s,n,r,i){return c(),o(p,null,[l("div",I,[this.generated.length===0?(c(),o("button",{key:0,class:"btn btn--main",onClick:t[0]||(t[0]=(...h)=>i.symbolGenrator&&i.symbolGenrator(...h))},"\u041D\u0430\u0447\u0430\u0442\u044C")):d("",!0)]),l("div",A,[(c(!0),o(p,null,g(s.generated,(h,u)=>(c(),o("span",{class:"symbol",key:h,onClick:t[1]||(t[1]=(...m)=>i.symbolCheck&&i.symbolCheck(...m)),"data-index":u},a(s.generated[u]),9,N))),128))])],64)}var w=_(b,[["render",O]]);const L={data(){return{}},props:{currentTime:Number,timeLeft:Number,timer:Number},methods:{timerStyle(){let e=Math.floor(this.currentTime/60)>9?Math.floor(this.currentTime/60):"0"+Math.floor(this.currentTime/60),t=this.currentTime-e*60>9?this.currentTime-e*60:"0"+(this.currentTime-e*60).toString();return`${e}:${t}`}}},M={class:"timer-wrapper timer-wrapper--sticky"},P={key:0,class:"timer"},G={key:1,class:"timer-out"};function R(e,t,s,n,r,i){return c(),o("div",M,[s.currentTime>0?(c(),o("div",P,a(i.timerStyle()),1)):s.currentTime===0?(c(),o("div",G,"\u0412\u0440\u0435\u043C\u044F \u0432\u044B\u0448\u043B\u043E!")):d("",!0)])}var U=_(L,[["render",R]]),K="/assets/test-1.0869c623.gif";const B={props:{accessSymbols:Array,checked:Array,intervalChecked:Array,success:Array,errosrs:Array,missed:Array,currentTime:Number,timerStatus:Number,testStatus:String},methods:{storageKeyType:function(e){return typeof localStorage[e]},maxArrayValue:function(e){let t=0;for(let s=0;s<e.length;s++)t<e[s]&&(t=e[s]);return t}}},D={class:"correcture info text-center"},E={key:0},V=l("h4",null,"\u0422\u0435\u0441\u0442 \u041A\u043E\u0440\u0440\u0435\u043A\u0442\u0443\u0440\u043D\u0430\u044F \u043F\u0440\u043E\u0431\u0430",-1),W=l("p",{class:"info__text"},' \u0417\u0430\u0434\u0430\u0447\u0430 \u2013 \u0432\u044B\u0434\u0435\u043B\u044F\u0442\u044C \u0442\u043E\u043B\u044C\u043A\u043E \u0431\u0443\u043A\u0432\u044B: "\u043C", "\u0430", "\u043A", "\u0432" \u0438\u0437 \u043F\u0440\u0435\u0434\u043E\u0441\u0442\u0430\u0432\u043B\u0435\u043D\u043D\u043E\u0433\u043E \u0441\u043F\u0438\u0441\u043A\u0430 \u0431\u0443\u043A\u0432. \u0412\u0440\u0435\u043C\u044F \u043D\u0430 \u043F\u0440\u043E\u0445\u043E\u0436\u0434\u0435\u043D\u0438\u0435 \u0442\u0435\u0441\u0442\u0430 \u0434\u0430\u0451\u0442\u0441\u044F 4 \u043C\u0438\u043D\u0443\u0442\u044B. \u0412 \u0441\u043B\u0443\u0447\u0430\u0435 \u043E\u0448\u0438\u0431\u043A\u0438, \u0432\u044B \u043C\u043E\u0436\u0435\u0442\u0435 \u043A\u043B\u0438\u043A\u043D\u0443\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043D\u0430 \u043D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0432\u044B\u0434\u0435\u043B\u0435\u043D\u043D\u0443\u044E \u0431\u0443\u043A\u0432\u0443, \u0442\u0430\u043A\u0438\u043C \u043E\u0431\u0440\u0430\u0437\u043E\u043C \u0443\u0431\u0440\u0430\u0432 \u043E\u0442\u043C\u0435\u0442\u043A\u0443 \u0441 \u043D\u0435\u0451. ',-1),F={key:0,class:"info__text"},$={key:1,class:""},j=l("p",null,"\u0412\u0430\u0448\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B:",-1),H={key:2,class:"text-center"},J=l("p",{class:"sub-text"},"\u0421\u043D\u0438\u0437\u0443 \u043F\u043E\u043A\u0430\u0437\u0430\u043D \u043F\u0440\u0438\u043C\u0435\u0440",-1),q=l("img",{class:"img",alt:"Test 2",src:K},null,-1),z=[J,q];function Q(e,t,s,n,r,i){return c(),o("div",D,[s.testStatus==="WAITING"||s.testStatus==="STARTED"?(c(),o("div",E,[V,W,i.storageKeyType("correcture")==="undefined"?(c(),o("p",F,[S(" \u0411\u0443\u043A\u0432\u044B \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043D\u0443\u0436\u043D\u043E \u0432\u044B\u0434\u0435\u043B\u044F\u0442\u044C: "),(c(!0),o(p,null,g(s.accessSymbols,h=>(c(),o("span",{key:h},a(h)+", ",1))),128))])):d("",!0)])):i.storageKeyType("correcture")!=="undefined"?(c(),o("div",$,[j,l("p",null,"\u041E\u0448\u0438\u0431\u043E\u043A: "+a(s.errosrs.length)+". \u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0445 \u0432\u044B\u0434\u0435\u043B\u0435\u043D\u0438\u0439:"+a(s.success.length)+". \u0412\u0441\u0435\u0433\u043E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0430\u043D\u043E \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432: "+a(i.maxArrayValue(s.checked))+". \u041F\u0440\u043E\u043F\u0443\u0449\u0435\u043D\u043E \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432: "+a(s.missed.length),1)])):d("",!0),s.testStatus==="WAITING"?(c(),o("div",H,z)):d("",!0)])}var X=_(B,[["render",Q]]);const Y={data(){return{showInfo:0,testStatus:"WAITING",currentTime:240,timeLeft:0,timer:null,timerStatus:0,modulo:null,accessSymbols:["\u043C","\u0430","\u043A","\u0432"],generated:[],checked:[],intervalChecked:[],success:[],errosrs:[],missed:[],results:[]}},emits:["correcture-unpassed","correcture-passed"],components:{CorrectureContent:w,CorrectureTimer:U,CorrectureInfo:X},methods:{...x("tests",["saveUserTest"]),showResults:function(){this.showInfo===0?this.showInfo=1:this.showInfo===1&&(this.showInfo=0)},startTimer(){this.timerStatus==0&&this.currentTime!==0&&(this.timer=setInterval(()=>{this.currentTime--,this.timeLeft++,this.modulo=this.timeLeft%60},1e3),this.timerStatus=1,this.testStatus="STARTED")},stopTimer(){clearTimeout(this.timer),this.timerStatus=0},generatedPush:function(e){this.generated.push(e)},checkedPush:function(e){this.checked.push(e),this.accessSymbols.indexOf(this.generated[e])!=-1?this.success.push(e):this.errosrs.push(e)},checkedUnset:function(e){let t=e[0],s=e[1],n=this.checked.indexOf(s),r=this.errosrs.indexOf(s),i=this.success.indexOf(s);n!==-1&&(this.checked.splice(n,1),t.classList.remove("active")),r!=-1&&this.errosrs.splice(r,1),i!=-1&&this.success.splice(i,1)},pushMissed:function(){this.missed=[];let e=0;for(let t=0;t<this.checked.length;t++)e<this.checked[t]&&(e=this.checked[t]);for(let t=0;t<e;t++)this.accessSymbols.indexOf(this.generated[t])!==-1&&this.missed.indexOf(t)===-1&&this.checked.indexOf(t)===-1&&this.missed.push(t)},getResult:function(){let e=this.intervalChecked.length,t=0;for(let s=0;s<e;s++){let n=0,r=0,i=0,h=0,u=this.intervalChecked[s];for(let f=t;f<u;f++)this.accessSymbols.indexOf(this.generated[f])!==-1&&n++,this.success.indexOf(f)!==-1&&r++,this.errosrs.indexOf(f)!==-1&&h++,this.missed.indexOf(f)!==-1&&i++;let m=Math.round((r-h)/n*100),C=Math.round((u-t)*m/100),v={viewSymbols:u-t,neededSymbols:n,successSymbols:r,missedSymbols:i,errorSymbols:h,accuracy:m,stability:C};t=u,this.results.push(v)}},storageKeyType:function(e){return typeof localStorage[e]},saveResults:function(){let e={generated:this.generated,checked:this.checked,success:this.success,errosrs:this.errosrs,interval:this.intervalChecked,missed:this.missed,results:this.results,test_id:1,user_id:this.getUser.id,attestation_id:this.attestationId};this.saveUserTest(e).then(t=>{this.$router.push("/tests")})},pullStorageData:function(e){this.generated=e[0],this.checked=e[1],this.success=e[2],this.errosrs=e[3],this.missed=e[4],this.intervalChecked=e[5],this.results=e[6]},clearTest:function(){this.generated=[],this.checked=[],this.success=[],this.errosrs=[],this.missed=[],this.intervalChecked=[],this.results=[],localStorage.removeItem("correcture"),this.currentTime=240,this.timeLeft=0,this.showInfo=1,this.$emit("correcture-unpadssed")},passed:function(){this.$emit("correcture-passed")}},unmounted(){this.stopTimer()},mounted(){typeof localStorage.correcture!="undefined"&&(this.testStatus="STORAGE"),this.attestationId===null&&this.$router.push("/tests")},computed:{...T("user",["getUser"]),...T("tests",["attestationId"])},watch:{currentTime(e){if(e===0&&(this.testStatus="FINISHED"),this.modulo===0){this.stopTimer(),setTimeout(()=>{if(this.modulo===0&&this.timeLeft/60>this.intervalChecked.length){let s=0;for(let n=0;n<this.checked.length;n++)s<this.checked[n]&&(s=this.checked[n]);this.intervalChecked.push(s)}this.startTimer()},5e3);let t=0;for(let s=0;s<this.checked.length;s++)t<this.checked[s]&&(t=this.checked[s]);this.intervalChecked.push(t)}e===0&&(this.stopTimer(),this.getResult(),this.saveResults())}}},Z={class:"container"};function ee(e,t,s,n,r,i){const h=k("CorrectureTimer"),u=k("CorrectureInfo"),m=k("CorrectureContent");return c(),o("div",Z,[i.storageKeyType("correcture")==="undefined"?(c(),y(h,{key:0,currentTime:r.currentTime,timeLeft:r.timeLeft,timer:r.timer},null,8,["currentTime","timeLeft","timer"])):d("",!0),i.storageKeyType("correcture")==="undefined"||r.showInfo===1?(c(),y(u,{key:1,timerStatus:r.timerStatus,accessSymbols:r.accessSymbols,success:r.success,errosrs:r.errosrs,checked:r.checked,intervalChecked:r.intervalChecked,missed:r.missed,currentTime:r.currentTime,testStatus:r.testStatus},null,8,["timerStatus","accessSymbols","success","errosrs","checked","intervalChecked","missed","currentTime","testStatus"])):d("",!0),i.storageKeyType("correcture")==="undefined"?(c(),y(m,{key:2,symbols:1925,generated:r.generated,checked:r.checked,currentTime:r.currentTime,modulo:r.modulo,onGeneratedPush:i.generatedPush,onCheckedPush:i.checkedPush,onCheckedUnset:i.checkedUnset,onStartTimer:i.startTimer,onCheckMissed:i.pushMissed},null,8,["generated","checked","currentTime","modulo","onGeneratedPush","onCheckedPush","onCheckedUnset","onStartTimer","onCheckMissed"])):d("",!0)])}var te=_(Y,[["render",ee]]);const se={components:{CorrectureComponent:te},methods:{testChecker(){this.correcture=!0}}};function re(e,t,s,n,r,i){const h=k("CorrectureComponent");return c(),y(h,{onCorrecturePassed:i.testChecker,onCorrectureUnpassed:t[0]||(t[0]=u=>e.correcture=!1)},null,8,["onCorrecturePassed"])}var ce=_(se,[["render",re]]);export{ce as default};
